---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
# image will be published to ghcr.io/<user>/<name>
name: vedaos-deck
description: This is my personal OS image.

base-image: ghcr.io/ublue-os/cosmic-atomic-main
# TODO: replace base image with upstream
image-version: 42

modules:
  - from-file: common.yml

  - type: dnf
    install:
      packages:
        - jupiter-fan-control
        - jupiter-hw-support-btrfs
        - galileo-mura
        - steamdeck-dsp
        - powerbuttond
        - adjustor
        - acpica-tools
        - vpower
        - steam_notif_daemon
        - sdgyrodsu
        - ibus-pinyin
        - ibus-table-chinese-cangjie
        - ibus-table-chinese-quick
        - socat
        - zstd
        - zenity
        - newt
        - xorg-x11-server-Xvfb
        - python-vdf
        - python-crcmod
    replace:
      - from-repo: copr:copr.fedorainfracloud.org:bazzite-org:bazzite
        packages:
          - upower

  - type: script
    snippets:
      - "dnf5 versionlock add upower upower-libs"
      - "mkdir -p /usr/share/gamescope-session-plus/"
      - "curl -Lo /usr/share/gamescope-session-plus/bootstrap_steam.tar.gz https://large-package-sources.nobaraproject.org/bootstrap_steam.tar.gz"

  - type: dnf
    install:
      packages:
        - gamescope-session-plus
        - gamescope-session-steam

  - type: initramfs

  - type: signing
