modules:
  - type: dnf
    remove:
      auto-remove: false
      packages:
        - kernel
        - kernel-core
        - kernel-modules
        - kernel-modules-core
        - kernel-modules-extra
        - kernel-tools
        - kernel-tools-libs
        - kernel-uki-virt

  - type: akmods
    base: bazzite
    install:
      - kernel
      - kernel-core
      - kernel-modules
      - kernel-modules-core
      - kernel-modules-extra
      - kernel-tools
      - kernel-tools-libs
      - kernel-devel
      - kernel-devel-matched

  - type: script
    snippets:
      - "dnf5 versionlock add kernel kernel-devel kernel-devel-matched kernel-core kernel-modules kernel-modules-core kernel-modules-extra kernel-tools kernel-tools-libs"

  - type: files
    files:
      - source: system
        destination: /

  - type: script
    snippets:
      - "curl -fsSL https://github.com/terrapkg/subatomic-repos/raw/main/terra.repo | tee /etc/yum.repos.d/terra.repo"

  - type: dnf
    install:
      packages:
        - terra-release

  - type: dnf
    repos:
      files:
        - https://negativo17.org/repos/fedora-steam.repo
        - https://pkgs.tailscale.com/stable/fedora/tailscale.repo
    install:
      install-weak-deps: false
      packages:
        - steam
        - extest.i686
        - glibc-gconv-extra
        - tailscale

  - type: script
    snippets:
      - "sed -i 's@/usr/bin/steam@/usr/bin/vedaos-steam@g' /usr/share/applications/steam.desktop"

  - type: os-release
    properties:
      ID: vedaos
      NAME: VedaOS
      PRETTY_NAME: VedaOS 42 (FROM Fedora COSMIC Atomic)

  - type: signing
